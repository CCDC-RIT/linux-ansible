#%PAM-1.0

# Authentication
auth        required      pam_env.so
auth        required      pam_faillock.so preauth
auth        sufficient    pam_unix.so try_first_pass
auth        [default=die] pam_faillock.so authfail
auth        sufficient    pam_faillock.so authsucc # needs this line otherwise it doesn't work
auth        required     pam_deny.so

# Account Management
account     required      pam_unix.so

# Password Management
password    requisite     pam_pwquality.so try_first_pass local_users_only
password    sufficient    pam_unix.so sha512 shadow try_first_pass use_authtok
password    required      pam_deny.so

# Session Management
session     optional      pam_keyinit.so revoke
session     required      pam_limits.so
session     required      pam_unix.so