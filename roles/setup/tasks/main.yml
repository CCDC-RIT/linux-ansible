---
- name: Add blueteam user
  ansible.builtin.user: 
    name: blueteam
    state: present
    shell: /bin/bash
    groups: "blueteam sudo wheel adm"
  ignore_errors: yes

- name: Add key to blueteam user
  ansible.posix.authorized_key:
    user: blueteam
    state: present
    key: "{{ lookup('file', '/opt/inventory/id_ed25519.pub') }}"

- name: Create backup directory
  ansible.builtin.file:
    path: "{{ backup_dir }}"
    owner: blueteam
    group: blueteam
    state: directory

- name: Create quarantine directory
  ansible.builtin.file:
    path: "{{ quarantine }}"
    owner: blueteam
    group: blueteam
    state: directory

- name: Append to /etc/hosts our new hosts #todo figure this out, use var "shortname" from inventory

- name: Install Common Packages
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    - "vim"
    - "curl"
    - "iptables"
    - "git"
    - "python3-pip"
    - "snoopy"
